# ============================================================================ #
# Boost Software License - Version 1.0 - August 17th, 2003
#
# Permission is hereby granted, free of charge, to any person or organization
# obtaining a copy of the software and accompanying documentation covered by
# this license (the "Software") to use, reproduce, display, distribute,
# execute, and transmit the Software, and to prepare derivative works of the
# Software, and to permit third-parties to whom the Software is furnished to
# do so, all subject to the following:
#
# The copyright notices in the Software and this entire statement, including
# the above license grant, this restriction and the following disclaimer,
# must be included in all copies of the Software, in whole or in part, and
# all derivative works of the Software, unless such copies or derivative
# works are solely in the form of machine-executable object code generated by
# a source language processor.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
# SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
# FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
# ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
# DEALINGS IN THE SOFTWARE.
#
# This project was copied from https://github.com/berenm/bplus-tree
# ============================================================================ #

project(bplus-tree C)

# CMake configuration:
cmake_minimum_required(VERSION 2.8)

# Set default built type to Release:
if(NOT CMAKE_BUILD_TYPE)
    set(CMAKE_BUILD_TYPE Release CACHE STRING
        "Choose the type of build, options are: Debug Release."
        FORCE)
endif()
set_property(CACHE CMAKE_BUILD_TYPE PROPERTY STRINGS Debug Release)

# Compiler options:
set(CMAKE_C_FLAGS "-Wall -std=gnu11 -fdiagnostics-show-option")
set(CMAKE_C_FLAGS_DEBUG "-O0 -g")
set(CMAKE_C_FLAGS_RELEASE "-Werror -O2 -DNDEBUG -fno-strict-aliasing")

include_directories(src)
include_directories(include)

set(BTREE_SOURCE
    src/bplus_foreach.c
    src/bplus_insert.c
    src/bplus_iterator.c
    src/bplus_leaf.c
    src/bplus_node.c
    src/bplus_rebalance.c
    src/bplus_remove.c
    src/bplus_search.c
    src/bplus_tree.c
    src/bplus_tree_private.h
    include/bplus_tree.h
)

add_library(bplus-tree STATIC ${BTREE_SOURCE})
set_target_properties(bplus-tree PROPERTIES OUTPUT_NAME bplus-tree)

# CPack installer configuration:
if(NOT CMAKE_INSTALL_PREFIX)
    set(CMAKE_INSTALL_PREFIX "/usr/local/" CACHE PATH
        "Default installation path." FORCE)
endif()

set(CPACK_RESOURCE_FILE_LICENSE
    "${CMAKE_SOURCE_DIR}/LICENSE")

install(FILES include/bplus_tree.h DESTINATION include)
install(TARGETS bplus-tree DESTINATION lib)

include(CPack)
